<!DOCTYPE html>
<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      layout:decorator="layouts/site"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"
      xmlns:layout="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8"/>
    <title>UMSpreadsheet</title>

    <link rel="stylesheet" th:href="@{/css/showReview.css}">
</head>

<body>
    <div layout:fragment="content">
        <div class="container">
            <h2 th:text="${#dates.format(show.date, 'yyyy/MM/dd') + ' ' + show.city + ', '  + show.state}"></h2>
            <h3 th:text="${show.venue}"></h3>
            <br>
            <br>
            <div th:if="${submitted == 'true'}" class="alert alert-success">
                Your review was submitted!
            </div>
            <table id="show-set-table" class="table table-striped table-condensed" th:each="setEntry : ${trackAndReviewMap}">
                <h4 th:text="${setEntry.key}">Set 1</h4>
                <thead>
                    <tr>
                        <th>Song</th>
                        <th>Rating</th>
                        <th>Review</th>
                        <th>Edit</th>
                        <th>Delete</th>
                    </tr>
                </thead>
                <tbody>
                    <th:block th:each="track,iterStat : ${setEntry.value}">
                        <th:block th:each="review : ${trackReviews}">
                            <th:block th:if="${review.track} == ${track}">
                                <tr></tr>
                            </th:block>
                        </th:block>
                    </th:block>

                    <tr th:each="trackAndReviewEntry,iterStat : ${setEntry.value}"
                        th:class="${trackAndReviewEntry.value != null}? 'success'">
                        <td th:text="${trackAndReviewEntry.key.song}">[song]</td>
                        <td th:text="(${trackAndReviewEntry.key.averageRating}?: '-')">[avg. rating]</td>
                        <td>
                            <a th:href="@{/user/review/track(trackId=${trackAndReviewEntry.key.id})}">
                                <i class="fa fa-plus" aria-hidden="true" style="color: green;"></i>
                            </a>
                        </td>
                        <td>
                            <a href="#" class="disabled">
                                <i class="fa fa-pencil" aria-hidden="true"></i>
                            </a>
                        </td>
                        <td>
                            <a href="#" class="disabled" style="color: red">
                                <i class="fa fa-trash" aria-hidden="true"></i>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>